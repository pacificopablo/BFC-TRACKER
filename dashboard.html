<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard â€“ Baccarat Fund Club</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
</head>
<body class="bg-gray-900 text-white p-6 min-h-screen">
  <div class="max-w-6xl mx-auto">
    <div class="flex justify-between items-center mb-6">
      <h1 class="text-3xl font-bold">ðŸ‘‘ Admin Dashboard</h1>
      <button onclick="logout()" class="bg-red-600 px-4 py-2 rounded hover:bg-red-700">Logout</button>
    </div>

    <!-- Add New Member Form -->
    <div class="bg-gray-800 p-6 rounded mb-8">
      <h2 class="text-xl font-bold mb-4">âž• Add New Member</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input id="addName" placeholder="Full Name" class="p-3 rounded bg-gray-700" />
        <input id="addEmail" placeholder="Email" class="p-3 rounded bg-gray-700" />
        <input id="addPhone" placeholder="Phone Number" class="p-3 rounded bg-gray-700" />
        <input id="addShares" type="number" placeholder="Shares" class="p-3 rounded bg-gray-700" />
        <input id="addBalance" type="number" placeholder="Initial Balance (â‚±)" class="p-3 rounded bg-gray-700" />
      </div>
      <button onclick="addMember()" class="mt-4 bg-blue-600 px-4 py-2 rounded hover:bg-blue-700">Add Member</button>
      <p id="addMsg" class="mt-2"></p>
    </div>

    <!-- Tab Filters -->
    <div class="mb-4 space-x-2 text-center">
      <button onclick="showTab('all')" class="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded">All</button>
      <button onclick="showTab('approved')" class="bg-green-600 hover:bg-green-700 px-4 py-2 rounded">Approved Only</button>
      <button onclick="showTab('pending')" class="bg-yellow-600 hover:bg-yellow-700 px-4 py-2 rounded">Pending Only</button>
    </div>

    <h2 class="text-xl font-bold mb-2" id="approvedTitle">ðŸ“‹ Approved Members</h2>
    <div id="approvedList" class="grid md:grid-cols-2 gap-4 mb-10"></div>

    <h2 class="text-xl font-bold mb-2" id="pendingTitle">ðŸ•“ Pending Registrations</h2>
    <div id="pendingList" class="grid md:grid-cols-2 gap-4"></div>
  </div>

  <script>
    function logout() {
      localStorage.clear();
      window.location.href = 'index.html';
    }

    function getMembers() {
      const approved = JSON.parse(localStorage.getItem("newMembers") || "[]");
      const pending  = JSON.parse(localStorage.getItem("pendingMembers") || "[]");
      return { approved, pending };
    }

    function saveMembers(approved, pending) {
      localStorage.setItem("newMembers", JSON.stringify(approved));
      localStorage.setItem("pendingMembers", JSON.stringify(pending));
    }

    // Add member manually (approved immediately)
    function addMember() {
      const name    = document.getElementById("addName").value.trim();
      const email   = document.getElementById("addEmail").value.trim().toLowerCase();
      const phone   = document.getElementById("addPhone").value.trim();
      const shares  = parseInt(document.getElementById("addShares").value);
      const balance = parseFloat(document.getElementById("addBalance").value);
      const msg     = document.getElementById("addMsg");

      if (!name || !email || !phone || !shares || isNaN(balance)) {
        msg.textContent = "âŒ Please fill all fields correctly.";
        msg.className = "text-red-500";
        return;
      }

      let { approved, pending } = getMembers();
      if (approved.some(m => m.email === email) || pending.some(m => m.email === email)) {
        msg.textContent = "âŒ Email already exists.";
        msg.className = "text-red-500";
        return;
      }

      const newMember = {
        id: Date.now().toString(),
        name, email, phone, shares, balance,
        deposits: 1, withdrawals: 0,
        joinDate: new Date().toISOString().split("T")[0]
      };

      approved.push(newMember);
      saveMembers(approved, pending);

      msg.textContent = "âœ… Member added and approved.";
      msg.className = "text-green-500";
      renderApproved(approved);
    }

    // Render functions
    function renderApproved(members) {
      const container = document.getElementById("approvedList");
      container.innerHTML = "";
      let totalShares = 0, totalBalance = 0;

      members.forEach((m, i) => {
        totalShares += m.shares;
        totalBalance += m.balance;

        const div = document.createElement("div");
        div.className = "bg-gray-800 p-4 rounded shadow space-y-2";
        div.innerHTML = `
          <p><strong>Name:</strong> <input value="${m.name}" onchange="updateField('approved', ${i}, 'name', this.value)" class="bg-gray-700 p-1 rounded w-full" /></p>
          <p><strong>Email:</strong> ${m.email}</p>
          <p><strong>Phone:</strong> <input value="${m.phone}" onchange="updateField('approved', ${i}, 'phone', this.value)" class="bg-gray-700 p-1 rounded w-full" /></p>
          <p><strong>Shares:</strong> <input type="number" value="${m.shares}" onchange="updateField('approved', ${i}, 'shares', this.value)" class="bg-gray-700 p-1 rounded w-full" /></p>
          <p><strong>Balance:</strong> â‚±<input type="number" value="${m.balance}" onchange="updateField('approved', ${i}, 'balance', this.value)" class="bg-gray-700 p-1 rounded w-full" /></p>
          <p><strong>Joined:</strong> ${m.joinDate}</p>
          <button onclick="removeMember(${i})" class="bg-red-600 mt-2 px-3 py-1 rounded hover:bg-red-700">Delete</button>
        `;
        container.appendChild(div);
      });

      const summary = document.createElement("div");
      summary.className = "col-span-2 bg-green-700 p-4 rounded mt-4";
      summary.innerHTML = `<strong>ðŸ“Š Total Shares:</strong> ${totalShares} | <strong>Total Balance:</strong> â‚±${totalBalance.toFixed(2)}`;
      container.appendChild(summary);
    }

    function renderPending(members) {
      const container = document.getElementById("pendingList");
      container.innerHTML = "";
      members.forEach((m, i) => {
        const div = document.createElement("div");
        div.className = "bg-gray-800 p-4 rounded shadow space-y-2";
        div.innerHTML = `
          <p><strong>Name:</strong> ${m.name}</p>
          <p><strong>Email:</strong> ${m.email}</p>
          <p><strong>Phone:</strong> ${m.phone}</p>
          <p><strong>Shares:</strong> ${m.shares}</p>
          <p><strong>Balance:</strong> â‚±${m.balance}</p>
          <p><strong>Joined:</strong> ${m.joinDate}</p>
          <div class="flex gap-4">
            <button onclick="approve(${i})" class="bg-green-600 px-3 py-1 rounded hover:bg-green-700">Approve</button>
            <button onclick="reject(${i})" class="bg-red-600 px-3 py-1 rounded hover:bg-red-700">Reject</button>
          </div>
        `;
        container.appendChild(div);
      });
    }

    function updateField(list, idx, field, value) {
      let { approved, pending } = getMembers();
      const target = list === 'approved' ? approved : pending;
      if (field==="shares"||field==="balance") value = parseFloat(value);
      target[idx][field] = value;
      saveMembers(approved, pending);
      renderApproved(approved);
      renderPending(pending);
    }

    function removeMember(i) {
      let { approved, pending } = getMembers();
      if (confirm("Delete this member?")) {
        approved.splice(i,1);
        saveMembers(approved, pending);
        renderApproved(approved);
      }
    }

    function approve(i) {
      let { approved, pending } = getMembers();
      approved.push(pending.splice(i,1)[0]);
      saveMembers(approved, pending);
      renderApproved(approved);
      renderPending(pending);
    }

    function reject(i) {
      let { approved, pending } = getMembers();
      if (confirm("Reject this registration?")) {
        pending.splice(i,1);
        saveMembers(approved, pending);
        renderPending(pending);
      }
    }

    function showTab(tab) {
      const aList = document.getElementById("approvedList"),
            pList = document.getElementById("pendingList"),
            aTitle= document.getElementById("approvedTitle"),
            pTitle= document.getElementById("pendingTitle");
      if(tab==="approved"){
        aList.style.display="grid"; aTitle.style.display="block";
        pList.style.display="none"; pTitle.style.display="none";
      } else if(tab==="pending"){
        aList.style.display="none"; aTitle.style.display="none";
        pList.style.display="grid"; pTitle.style.display="block";
      } else {
        aList.style.display="grid"; aTitle.style.display="block";
        pList.style.display="grid"; pTitle.style.display="block";
      }
    }

    // Initial render
    const { approved, pending } = getMembers();
    renderApproved(approved);
    renderPending(pending);
  </script>
</body>
</html>
